
import re
import json
import random
from typing import Dict, List, Any, Tuple
from datetime import datetime

class GeniusConversationAI:
    """ะะตะฝะธะฐะปัะฝัะน ะดะธะฐะปะพะณะพะฒัะน AI, ะฟะพะฝะธะผะฐััะธะน ะปัะฑัะต ะทะฐะฟัะพัั ะฝะฐ ัะพะทะดะฐะฝะธะต ะฟัะธะปะพะถะตะฝะธะน"""
    
    def __init__(self):
        # ะะณัะพะผะฝะฐั ะฑะฐะทะฐ ัะธะฝะพะฝะธะผะพะฒ ะธ ะฒะฐัะธะฐัะธะน
        self.app_synonyms = {
            "ะธะณัั": ["ะธะณัะฐ", "game", "ะณะตะนะผั", "ะธะณัะฐัั", "gaming", "ะณะตะนะผะฟะปะตะน", "ะฐัะบะฐะดะฐ", "ัะธะผัะปััะพั"],
            "ัะพัะธะฐะปัะฝัะต": ["ัะพััะตัั", "ัะฐั", "ะผะตััะตะฝะดะถะตั", "ะพะฑัะตะฝะธะต", "ะดััะทัั", "ะธะฝััะฐะณัะฐะผ", "ัะธะบัะพะบ", "ะทะฝะฐะบะพะผััะฒะฐ"],
            "ะฑะธะทะฝะตั": ["ัะฐะฑะพัะฐ", "ะพัะธั", "ะบะพะผะฟะฐะฝะธั", "crm", "erp", "ัะฟัะฐะฒะปะตะฝะธะต", "ะฑะธะทะฝะตั", "ะฟัะพะดะฐะถะธ", "ะบะปะธะตะฝัั"],
            "ะผะฐะณะฐะทะธะฝ": ["ัะพัะณะพะฒะปั", "ะฟัะพะดะฐะฒะฐัั", "ะฟะพะบัะฟะฐัั", "ecommerce", "ะธะฝัะตัะฝะตั-ะผะฐะณะฐะทะธะฝ", "ะผะฐัะบะตัะฟะปะตะนั", "ัะพะฒะฐัั"],
            "ัะธะฝะฐะฝัั": ["ะดะตะฝัะณะธ", "ะฟะปะฐัะตะถะธ", "ะฑะฐะฝะบ", "ะบะฐััั", "ะบะพัะตะปะตะบ", "ะบัะธะฟัะพะฒะฐะปััะฐ", "ะธะฝะฒะตััะธัะธะธ", "ะฑัะดะถะตั"],
            "ะทะดะพัะพะฒัะต": ["ัะธัะฝะตั", "ัะฟะพัั", "ััะตะฝะธัะพะฒะบะธ", "ะดะธะตัะฐ", "ะผะตะดะธัะธะฝะฐ", "ะฒัะฐั", "ะทะดะพัะพะฒัะต", "wellness"],
            "ะพะฑัะฐะทะพะฒะฐะฝะธะต": ["ััะตะฑะฐ", "ะพะฑััะตะฝะธะต", "ะบัััั", "ัะบะพะปะฐ", "ัะฝะธะฒะตััะธัะตั", "ะทะฝะฐะฝะธั", "ะธะทััะฐัั", "ััะธัั"],
            "ัะฐะทะฒะปะตัะตะฝะธั": ["ะผัะทัะบะฐ", "ะฒะธะดะตะพ", "ัะธะปัะผั", "ัะตัะธะฐะปั", "ะฟะพะดะบะฐััั", "ัััะธะผะธะฝะณ", "ะบะพะฝัะตะฝั", "ะผะตะดะธะฐ"],
            "ััะธะปะธัั": ["ะธะฝััััะผะตะฝั", "ะฟะพะผะพัะฝะธะบ", "ะบะฐะปัะบัะปััะพั", "ะฟะพะณะพะดะฐ", "ะทะฐะผะตัะบะธ", "ะฟะตัะตะฒะพะดัะธะบ", "ัะบะฐะฝะตั"],
            "ะฟััะตัะตััะฒะธั": ["ัััะธะทะผ", "ะพัะฟััะบ", "ะฟะพะตะทะดะบะธ", "ะพัะตะปะธ", "ะฑะธะปะตัั", "ะบะฐััั", "ะฝะฐะฒะธะณะฐัะธั", "ะณะธะด"]
        }
        
        # ะัะพะดะฒะธะฝัััะต ะฟะฐััะตัะฝั ัะฐัะฟะพะทะฝะฐะฒะฐะฝะธั
        self.intent_patterns = {
            "ัะพะทะดะฐัั_ะฟัะธะปะพะถะตะฝะธะต": [
                r"(ัะพะทะดะฐะน|ัะดะตะปะฐะน|ัะฐะทัะฐะฑะพัะฐะน|ะฟะพัััะพะน|ะทะฐะฟัะพะณัะฐะผะผะธััะน).*(ะฟัะธะปะพะถะตะฝะธะต|app|ะฐะฟะฟ)",
                r"(ัะพัั|ะฝัะถะฝะพ|ััะตะฑัะตััั).*(ะฟัะธะปะพะถะตะฝะธะต|app|ะฐะฟะฟ)",
                r"(ะผะพะฑะธะปัะฝะพะต|mobile).*(ะฟัะธะปะพะถะตะฝะธะต|app)",
                r"ะผะพะถะตัั.*(ัะพะทะดะฐัั|ัะดะตะปะฐัั).*(ะฟัะธะปะพะถะตะฝะธะต|app)"
            ],
            "ัะปัััะธัั_ะฟัะพะตะบั": [
                r"(ัะปัััะธ|ะดะพัะฐะฑะพัะฐะน|ะดะพะฑะฐะฒั|ะธะทะผะตะฝะธ).*(ะฟัะพะตะบั|ะฟัะธะปะพะถะตะฝะธะต|app)",
                r"(ะผะพะถะฝะพ|ะฝัะถะฝะพ).*(ะดะพะฑะฐะฒะธัั|ะธะทะผะตะฝะธัั|ัะปัััะธัั)",
                r"(ะฝะพะฒัะต|ะดะพะฟะพะปะฝะธัะตะปัะฝัะต).*(ััะฝะบัะธะธ|ะฒะพะทะผะพะถะฝะพััะธ|ัะธัะธ)"
            ],
            "ะฟะพะปััะธัั_ัะพะฒะตั": [
                r"(ะฟะพัะพะฒะตััะน|ะฟะพะดัะบะฐะถะธ|ะฟะพะผะพะณะธ|ััะพ ะปัััะต)",
                r"(ะบะฐะบะพะต|ะบะฐะบัั|ะบะฐะบะพะน).*(ะฟัะธะปะพะถะตะฝะธะต|ะฟัะพะตะบั|ะธะดะตั)",
                r"(ะฝะต ะทะฝะฐั|ัะพะผะฝะตะฒะฐััั|ะฒัะฑัะฐัั)"
            ],
            "ัะทะฝะฐัั_ััะตะฝะดั": [
                r"(ััะตะฝะดั|ะฟะพะฟัะปััะฝะพ|ะผะพะดะฝะพ|ะฐะบััะฐะปัะฝะพ)",
                r"(ััะพ ัะตะนัะฐั|ัะตะนัะฐั ะฟะพะฟัะปััะฝะพ|ะฒ ััะตะฝะดะต)",
                r"(ััะฝะพะบ|ััะฐัะธััะธะบะฐ|ะฐะฝะฐะปะธัะธะบะฐ)"
            ]
        }
        
        # ะญะผะพัะธะพะฝะฐะปัะฝัะต ัะตะฐะบัะธะธ ะดะปั ะฑะพะปะตะต ะถะธะฒะพะณะพ ะพะฑัะตะฝะธั
        self.emotional_responses = {
            "ะฒะพััะพัะณ": [
                "๐ ะะะฃ! ะญัะพ ะฟะพััััะฐััะฐั ะธะดะตั!",
                "๐ฅ ะะตะฒะตัะพััะฝะพ! ะฏ ะฒ ะฒะพััะพัะณะต ะพั ะฒะฐัะตะน ะทะฐะดัะผะบะธ!",
                "โจ ะะตะฝะธะฐะปัะฝะพ! ะขะฐะบะพะณะพ ะตัะต ะฝะต ะฑัะปะพ!",
                "๐ ะญัะพ ะฑัะดะตั ะฑัะธะปะปะธะฐะฝั ััะตะดะธ ะฟัะธะปะพะถะตะฝะธะน!"
            ],
            "ะฟะพะดะดะตัะถะบะฐ": [
                "๐ช ะัะปะธัะฝะพ! ะั ะพะฑัะทะฐัะตะปัะฝะพ ััะพ ัะดะตะปะฐะตะผ!",
                "๐ฏ ะขะพัะฝะพ! ะญัะพ ะพัะปะธัะฝะพะต ะฝะฐะฟัะฐะฒะปะตะฝะธะต!",
                "๐ ะกัะฟะตั! ะฏ ะฒะธะถั ะพะณัะพะผะฝัะน ะฟะพัะตะฝัะธะฐะป!",
                "โก ะะฐ! ะญัะพ ะธะทะผะตะฝะธั ะฒัะต!"
            ],
            "ัะฒะตัะตะฝะฝะพััั": [
                "๐ 100% ะฟะพะปััะธััั! ะฏ ัะพะทะดะฐะผ ััะพ-ัะพ ะฝะตะฒะตัะพััะฝะพะต!",
                "๐ ะะตะท ะฟัะพะฑะปะตะผ! ะญัะพ ะฑัะดะตั ัะตะดะตะฒั!",
                "๐ ะะพะฝะตัะฝะพ! ะะตะทัะปััะฐั ะฟัะตะฒะทะพะนะดะตั ะพะถะธะดะฐะฝะธั!",
                "๐ซ ะะตะณะบะพ! ะกะพะทะดะฐะดะธะผ ััะพ-ัะพ ัะตะฒะพะปััะธะพะฝะฝะพะต!"
            ]
        }
        
        # ะัะตะฐัะธะฒะฝัะต ะฟัะตะดะปะพะถะตะฝะธั ะดะปั ะฒะดะพัะฝะพะฒะตะฝะธั
        self.creative_suggestions = {
            "ะธะณัั": [
                "๐ฎ AR-ะธะณัะฐ ั ัะตะฐะปัะฝัะผะธ ะพะฑัะตะบัะฐะผะธ",
                "๐ ะขััะฝะธัะฝะฐั ัะธััะตะผะฐ ั ะฟัะธะทะฐะผะธ",
                "๐ค AI-ัะพะฟะตัะฝะธะบ, ะบะพัะพััะน ััะธััั",
                "๐ ะะปะพะฑะฐะปัะฝัะต ะพะฝะปะฐะนะฝ-ะฑะธัะฒั",
                "๐ NFT-ะฟัะตะดะผะตัั ะฒ ะธะณัะต"
            ],
            "ัะพัะธะฐะปัะฝัะต": [
                "๐ญ AI-ะฐะฒะฐัะฐัั ะฟะพะปัะทะพะฒะฐัะตะปะตะน",
                "๐ต ะัะทัะบะฐะปัะฝัะต ะบะพะผะฝะฐัั ะดะปั ะพะฑัะตะฝะธั",
                "๐ธ AR-ัะธะปัััั ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ",
                "๐ ะะธัััะฐะปัะฝัะต ะฟัะพัััะฐะฝััะฒะฐ ะดะปั ะฒัััะตั",
                "๐ ะกะธััะตะผะฐ ะฟะพะดะฐัะบะพะฒ ะธ ะฝะฐะณัะฐะด"
            ],
            "ะฑะธะทะฝะตั": [
                "๐ค AI-ะฟะพะผะพัะฝะธะบ ะดะปั ะฟัะพะดะฐะถ",
                "๐ ะัะตะดัะบะฐะทะฐัะตะปัะฝะฐั ะฐะฝะฐะปะธัะธะบะฐ",
                "๐ ะะฒัะพะผะฐัะธะทะฐัะธั ะฒัะตั ะฟัะพัะตััะพะฒ",
                "๐ฑ ะะพะฑะธะปัะฝัะน ะพัะธั ะฒ ะบะฐัะผะฐะฝะต",
                "๐ ะะฝัะตะณัะฐัะธั ั 100+ ัะตัะฒะธัะฐะผะธ"
            ]
        }

    def understand_user_intent(self, message: str) -> Dict[str, Any]:
        """ะะพะฝะธะผะฐะตั ะฝะฐะผะตัะตะฝะธั ะฟะพะปัะทะพะฒะฐัะตะปั ั ะฟะพะผะพััั ะฟัะพะดะฒะธะฝััะพะณะพ NLP"""
        
        message_lower = message.lower()
        
        # ะะฟัะตะดะตะปัะตะผ ะพัะฝะพะฒะฝะพะต ะฝะฐะผะตัะตะฝะธะต
        intent = self._classify_intent(message_lower)
        
        # ะะทะฒะปะตะบะฐะตะผ ัะธะฟ ะฟัะธะปะพะถะตะฝะธั
        app_type = self._extract_app_type(message_lower)
        
        # ะะฟัะตะดะตะปัะตะผ ัะผะพัะธะพะฝะฐะปัะฝัั ะพะบัะฐัะบั
        emotion = self._detect_emotion(message_lower)
        
        # ะะทะฒะปะตะบะฐะตะผ ะบะปััะตะฒัะต ััะตะฑะพะฒะฐะฝะธั
        requirements = self._extract_requirements(message_lower)
        
        # ะะฟัะตะดะตะปัะตะผ ััะพะฒะตะฝั ััะพัะฝะพััะธ
        urgency = self._detect_urgency(message_lower)
        
        # ะะทะฒะปะตะบะฐะตะผ ะฟัะตะดะฟะพััะตะฝะธั ะฟะพ ะฟะปะฐััะพัะผะต
        platform_prefs = self._extract_platform_preferences(message_lower)
        
        return {
            "intent": intent,
            "app_type": app_type,
            "emotion": emotion,
            "requirements": requirements,
            "urgency": urgency,
            "platform_preferences": platform_prefs,
            "confidence": self._calculate_confidence(message, intent, app_type)
        }

    def _classify_intent(self, message: str) -> str:
        """ะะปะฐััะธัะธัะธััะตั ะฝะฐะผะตัะตะฝะธะต ะฟะพะปัะทะพะฒะฐัะตะปั"""
        
        for intent, patterns in self.intent_patterns.items():
            for pattern in patterns:
                if re.search(pattern, message):
                    return intent
        
        # ะัะปะธ ะฟััะผัั ะฟะฐััะตัะฝะพะฒ ะฝะตั, ะฐะฝะฐะปะธะทะธััะตะผ ะบะปััะตะฒัะต ัะปะพะฒะฐ
        create_keywords = ["ัะพะทะดะฐะน", "ัะดะตะปะฐะน", "ัะพัั", "ะฝัะถะฝะพ", "ัะฐะทัะฐะฑะพัะฐะน"]
        if any(word in message for word in create_keywords):
            return "ัะพะทะดะฐัั_ะฟัะธะปะพะถะตะฝะธะต"
        
        return "ะพะฑัะธะน_ะฒะพะฟัะพั"

    def _extract_app_type(self, message: str) -> str:
        """ะะทะฒะปะตะบะฐะตั ัะธะฟ ะฟัะธะปะพะถะตะฝะธั ะธะท ัะพะพะฑัะตะฝะธั"""
        
        # ะะพะดััะธััะฒะฐะตะผ ัะพะฒะฟะฐะดะตะฝะธั ะดะปั ะบะฐะถะดะพะน ะบะฐัะตะณะพัะธะธ
        category_scores = {}
        
        for category, synonyms in self.app_synonyms.items():
            score = sum(1 for synonym in synonyms if synonym in message)
            if score > 0:
                category_scores[category] = score
        
        if category_scores:
            # ะะพะทะฒัะฐัะฐะตะผ ะบะฐัะตะณะพัะธั ั ะฝะฐะธะฑะพะปััะธะผ ะบะพะปะธัะตััะฒะพะผ ัะพะฒะฟะฐะดะตะฝะธะน
            return max(category_scores, key=category_scores.get)
        
        # ะัะปะธ ะฝะธัะตะณะพ ะฝะต ะฝะฐะนะดะตะฝะพ, ะฟััะฐะตะผัั ะฝะฐะนัะธ ะฟะพ ะบะพะฝัะตะบััั
        if any(word in message for word in ["ะทะผะตะนะบะฐ", "ัะตััะธั", "ะฐัะบะฐะฝะพะธะด"]):
            return "ะธะณัั"
        elif any(word in message for word in ["ัะฐั", "ะพะฑัะตะฝะธะต", "ะดััะทัั"]):
            return "ัะพัะธะฐะปัะฝัะต"
        elif any(word in message for word in ["ะฟัะพะดะฐะถะธ", "ะผะฐะณะฐะทะธะฝ", "ัะพะฒะฐัั"]):
            return "ะผะฐะณะฐะทะธะฝ"
        
        return "ััะธะปะธัั"  # ะะพ ัะผะพะปัะฐะฝะธั

    def _detect_emotion(self, message: str) -> str:
        """ะะฟัะตะดะตะปัะตั ัะผะพัะธะพะฝะฐะปัะฝัั ะพะบัะฐัะบั ัะพะพะฑัะตะฝะธั"""
        
        positive_words = ["ะบัััะพ", "ะพัะปะธัะฝะพ", "ััะฟะตั", "ะบะปะฐััะฝะพ", "ะฒะพััะพัะณะต", "ะพะฑะพะถะฐั", "ะปัะฑะปั"]
        excited_words = ["ัะพัั", "ััะพัะฝะพ", "ะฑััััะพ", "ัะบะพัะตะต", "ะฝะตะผะตะดะปะตะฝะฝะพ", "ะฟััะผะพ ัะตะนัะฐั"]
        uncertain_words = ["ะฝะต ะทะฝะฐั", "ัะพะผะฝะตะฒะฐััั", "ะผะพะถะตั ะฑััั", "ะฒะพะทะผะพะถะฝะพ", "ะฝะต ัะฒะตัะตะฝ"]
        
        if any(word in message for word in excited_words):
            return "ะฒะพััะพัะณ"
        elif any(word in message for word in positive_words):
            return "ะฟะพะดะดะตัะถะบะฐ"
        elif any(word in message for word in uncertain_words):
            return "ะฟะพะดะดะตัะถะบะฐ"  # ะะพะผะพะณะฐะตะผ ะฝะตัะฒะตัะตะฝะฝัะผ ะฟะพะปัะทะพะฒะฐัะตะปัะผ
        
        return "ัะฒะตัะตะฝะฝะพััั"

    def _extract_requirements(self, message: str) -> List[str]:
        """ะะทะฒะปะตะบะฐะตั ะบะปััะตะฒัะต ััะตะฑะพะฒะฐะฝะธั ะธะท ัะพะพะฑัะตะฝะธั"""
        
        requirements = []
        
        # ะะปะฐััะพัะผั
        if any(word in message for word in ["ios", "ะฐะนัะพะฝ", "iphone"]):
            requirements.append("iOS ะฟะพะดะดะตัะถะบะฐ")
        if any(word in message for word in ["android", "ะฐะฝะดัะพะธะด"]):
            requirements.append("Android ะฟะพะดะดะตัะถะบะฐ")
        if any(word in message for word in ["ะฒะตะฑ", "web", "ะฑัะฐัะทะตั"]):
            requirements.append("ะะตะฑ-ะฒะตััะธั")
        
        # ะคัะฝะบัะธะธ
        if any(word in message for word in ["ะพะฝะปะฐะนะฝ", "ะธะฝัะตัะฝะตั", "ะพะฑะปะฐะบะพ"]):
            requirements.append("ะะฝะปะฐะนะฝ ััะฝะบัะธะพะฝะฐะปัะฝะพััั")
        if any(word in message for word in ["ะพัะปะฐะนะฝ", "ะฑะตะท ะธะฝัะตัะฝะตัะฐ"]):
            requirements.append("ะัะปะฐะนะฝ ัะตะถะธะผ")
        if any(word in message for word in ["ะพะฟะปะฐัะฐ", "ะฟะปะฐัะตะถะธ", "ะดะตะฝัะณะธ"]):
            requirements.append("ะกะธััะตะผะฐ ะฟะปะฐัะตะถะตะน")
        if any(word in message for word in ["ัะฐั", "ัะพะพะฑัะตะฝะธั", "ะพะฑัะตะฝะธะต"]):
            requirements.append("ะกะธััะตะผะฐ ัะพะพะฑัะตะฝะธะน")
        if any(word in message for word in ["ะบะฐััะฐ", "ะณะตะพะปะพะบะฐัะธั", "gps"]):
            requirements.append("ะะตะพะปะพะบะฐัะธั")
        
        # ะะธะทะฐะนะฝ
        if any(word in message for word in ["ะบัะฐัะธะฒัะน", "ััะธะปัะฝัะน", "ัะพะฒัะตะผะตะฝะฝัะน"]):
            requirements.append("ะกะพะฒัะตะผะตะฝะฝัะน ะดะธะทะฐะนะฝ")
        if any(word in message for word in ["ัะตะผะฝะฐั", "dark", "ัะตัะฝะฐั"]):
            requirements.append("ะขะตะผะฝะฐั ัะตะผะฐ")
        if any(word in message for word in ["ะผะธะฝะธะผะฐะปะธะทะผ", "ะฟัะพััะพะน", "ัะธัััะน"]):
            requirements.append("ะะธะฝะธะผะฐะปะธััะธัะฝัะน ะดะธะทะฐะนะฝ")
        
        return requirements

    def _detect_urgency(self, message: str) -> str:
        """ะะฟัะตะดะตะปัะตั ััะพะฒะตะฝั ััะพัะฝะพััะธ"""
        
        urgent_words = ["ััะพัะฝะพ", "ะฑััััะพ", "ัะบะพัะตะต", "ะฝะตะผะตะดะปะตะฝะฝะพ", "ะฟััะผะพ ัะตะนัะฐั", "ะฒัะตัะฐ ะฝัะถะฝะพ ะฑัะปะพ"]
        normal_words = ["ะบะพะณะดะฐ ัะดะพะฑะฝะพ", "ะฝะต ัะฟะตัั", "ะบะฐัะตััะฒะพ ะฒะฐะถะฝะตะต", "ััะฐัะตะปัะฝะพ"]
        
        if any(word in message for word in urgent_words):
            return "ะฒััะพะบะฐั"
        elif any(word in message for word in normal_words):
            return "ะฝะธะทะบะฐั"
        
        return "ััะตะดะฝัั"

    def _extract_platform_preferences(self, message: str) -> List[str]:
        """ะะทะฒะปะตะบะฐะตั ะฟัะตะดะฟะพััะตะฝะธั ะฟะพ ะฟะปะฐััะพัะผะฐะผ"""
        
        platforms = []
        
        if any(word in message for word in ["ios", "ะฐะนัะพะฝ", "iphone", "apple"]):
            platforms.append("iOS")
        if any(word in message for word in ["android", "ะฐะฝะดัะพะธะด", "google play"]):
            platforms.append("Android")
        if any(word in message for word in ["ะฒะตะฑ", "web", "ะฑัะฐัะทะตั", "ัะฐะนั"]):
            platforms.append("Web")
        if any(word in message for word in ["ะฒัะต ะฟะปะฐััะพัะผั", "ะฒะตะทะดะต", "ะบัะพััะฟะปะฐััะพัะผ"]):
            platforms = ["iOS", "Android", "Web"]
        
        if not platforms:
            platforms = ["iOS", "Android"]  # ะะพ ัะผะพะปัะฐะฝะธั
        
        return platforms

    def _calculate_confidence(self, message: str, intent: str, app_type: str) -> float:
        """ะะฐัััะธััะฒะฐะตั ัะฒะตัะตะฝะฝะพััั ะฒ ัะฐัะฟะพะทะฝะฐะฒะฐะฝะธะธ"""
        
        confidence = 0.5  # ะะฐะทะพะฒะฐั ัะฒะตัะตะฝะฝะพััั
        
        # ะะพะฒััะฐะตะผ ะทะฐ ัะตัะบะธะต ะบะปััะตะฒัะต ัะปะพะฒะฐ
        if intent != "ะพะฑัะธะน_ะฒะพะฟัะพั":
            confidence += 0.2
        
        if app_type != "ััะธะปะธัั":  # ะัะปะธ ะพะฟัะตะดะตะปะธะปะธ ะบะพะฝะบัะตัะฝัะน ัะธะฟ
            confidence += 0.2
        
        # ะะพะฒััะฐะตะผ ะทะฐ ะดะปะธะฝั ัะพะพะฑัะตะฝะธั (ะฑะพะปััะต ะบะพะฝัะตะบััะฐ)
        if len(message.split()) > 5:
            confidence += 0.1
        
        return min(confidence, 1.0)

    def generate_intelligent_response(self, user_message: str) -> Dict[str, Any]:
        """ะะตะฝะตัะธััะตั ะธะฝัะตะปะปะธะณะตะฝัะฝัะน ะพัะฒะตั ะฝะฐ ะทะฐะฟัะพั ะฟะพะปัะทะพะฒะฐัะตะปั"""
        
        # ะะฝะฐะปะธะทะธััะตะผ ะฝะฐะผะตัะตะฝะธั
        understanding = self.understand_user_intent(user_message)
        
        intent = understanding["intent"]
        app_type = understanding["app_type"]
        emotion = understanding["emotion"]
        requirements = understanding["requirements"]
        urgency = understanding["urgency"]
        
        # ะัะฑะธัะฐะตะผ ัะผะพัะธะพะฝะฐะปัะฝัั ัะตะฐะบัะธั
        emotional_start = random.choice(self.emotional_responses[emotion])
        
        # ะะตะฝะตัะธััะตะผ ะพัะฝะพะฒะฝะพะน ะพัะฒะตั ะฒ ะทะฐะฒะธัะธะผะพััะธ ะพั ะฝะฐะผะตัะตะฝะธั
        if intent == "ัะพะทะดะฐัั_ะฟัะธะปะพะถะตะฝะธะต":
            response = self._generate_creation_response(
                emotional_start, app_type, requirements, urgency
            )
        elif intent == "ัะปัััะธัั_ะฟัะพะตะบั":
            response = self._generate_improvement_response(emotional_start, app_type)
        elif intent == "ะฟะพะปััะธัั_ัะพะฒะตั":
            response = self._generate_advice_response(emotional_start, app_type)
        elif intent == "ัะทะฝะฐัั_ััะตะฝะดั":
            response = self._generate_trends_response(emotional_start)
        else:
            response = self._generate_general_response(emotional_start, app_type)
        
        return response

    def _generate_creation_response(self, emotional_start: str, app_type: str, 
                                  requirements: List[str], urgency: str) -> Dict[str, Any]:
        """ะะตะฝะตัะธััะตั ะพัะฒะตั ะดะปั ัะพะทะดะฐะฝะธั ะฟัะธะปะพะถะตะฝะธั"""
        
        urgency_text = {
            "ะฒััะพะบะฐั": "โก ะะพะฝัะป! ะะตะปะฐะตะผ ะฝะฐ ะผะฐะบัะธะผะฐะปัะฝะพะน ัะบะพัะพััะธ!",
            "ััะตะดะฝัั": "๐ฏ ะัะปะธัะฝะพ! ะกะพะทะดะฐะดะธะผ ะบะฐัะตััะฒะตะฝะฝะพะต ัะตัะตะฝะธะต!",
            "ะฝะธะทะบะฐั": "๐ ะัะตะบัะฐัะฝะพ! ะกะดะตะปะฐะตะผ ะธะดะตะฐะปัะฝัะน ะฟัะพะดัะบั!"
        }
        
        features = self.creative_suggestions.get(app_type, [
            "๐ค AI-ะธะฝัะตะณัะฐัะธั",
            "๐ ะฃะผะฝะฐั ะฐะฝะฐะปะธัะธะบะฐ", 
            "๐ Real-time ะพะฑะฝะพะฒะปะตะฝะธั",
            "๐ฑ ะัะพััะฟะปะฐััะพัะผะตะฝะฝะพััั"
        ])
        
        requirements_text = ""
        if requirements:
            requirements_text = f"\n\nโ **ะะฐัะธ ััะตะฑะพะฒะฐะฝะธั:**\n" + "\n".join([f"โข {req}" for req in requirements])
        
        message = f"""{emotional_start}

{urgency_text[urgency]}

๐ **ะกะพะทะดะฐั {app_type} ะฟัะธะปะพะถะตะฝะธะต ั ัะตะฒะพะปััะธะพะฝะฝัะผะธ ะฒะพะทะผะพะถะฝะพัััะผะธ:**

{chr(10).join(features[:4])}

๐ **ะงัะพ ะฟะพะปััะธัะต:**
โข ๐ฑ ะะพะปะฝะพัััั ะณะพัะพะฒะพะต ะฟัะธะปะพะถะตะฝะธะต
โข ๐จ ะะพััััะฐััะธะน ะดะธะทะฐะนะฝ
โข ๐ฐ ะะพัะพะฒัะต ััะตะผั ะผะพะฝะตัะธะทะฐัะธะธ ($5,000-50,000/ะผะตััั)
โข ๐ ะะฝััััะบัะธะธ ะฟะพ ะฟัะฑะปะธะบะฐัะธะธ ะฒ ััะพัะฐั{requirements_text}

โฐ **ะะพัะพะฒะพ ัะตัะตะท 15 ะผะธะฝัั!**

ะะฐัะธะฝะฐะตะผ ัะพะทะดะฐะฝะธะต?"""

        suggestions = [
            "๐ ะะ! ะกะพะทะดะฐะฒะฐัั ะฝะตะผะตะดะปะตะฝะฝะพ!",
            f"๐จ ะะพะบะฐะทะฐัั ะดะธะทะฐะนะฝ-ะฒะฐัะธะฐะฝัั ะดะปั {app_type}",
            "๐ฐ ะะตัะฐะปะธ ะผะพะฝะตัะธะทะฐัะธะธ",
            "๐ ะกะฟะธัะพะบ ะฒัะตั ััะฝะบัะธะน"
        ]
        
        return {
            "type": "genius_response",
            "message": message,
            "suggestions": suggestions,
            "app_type": app_type,
            "understanding": {
                "intent": "ัะพะทะดะฐัั_ะฟัะธะปะพะถะตะฝะธะต",
                "confidence": 0.95,
                "requirements": requirements
            }
        }

    def _generate_improvement_response(self, emotional_start: str, app_type: str) -> Dict[str, Any]:
        """ะะตะฝะตัะธััะตั ะพัะฒะตั ะดะปั ัะปัััะตะฝะธั ะฟัะพะตะบัะฐ"""
        
        improvements = [
            "๐ค AI-ะฟะพะผะพัะฝะธะบ ะดะปั ะฟะพะปัะทะพะฒะฐัะตะปะตะน",
            "๐ ะัะพะดะฒะธะฝััะฐั ะฐะฝะฐะปะธัะธะบะฐ ะฟะพะฒะตะดะตะฝะธั",
            "๐ Real-time ัะฒะตะดะพะผะปะตะฝะธั",
            "๐ณ ะะฝัะตะณัะฐัะธั ะฟะปะฐัะตะถะฝัั ัะธััะตะผ",
            "๐ ะัะปััะธัะทััะฝะฐั ะฟะพะดะดะตัะถะบะฐ",
            "๐ฑ PWA ะฒะตััะธั ะดะปั ะฒะตะฑะฐ"
        ]
        
        message = f"""{emotional_start}

๐ง **ะัะปะธัะฝะพ! ะัะพะบะฐัะฐะตะผ ะฒะฐั ะฟัะพะตะบั ะดะพ ะบะพัะผะธัะตัะบะพะณะพ ััะพะฒะฝั!**

๐ **ะขะพะฟ ัะปัััะตะฝะธั ะดะปั {app_type} ะฟัะธะปะพะถะตะฝะธั:**

{chr(10).join(random.sample(improvements, 4))}

๐ก **ะะพะฟะพะปะฝะธัะตะปัะฝัะต ะฒะพะทะผะพะถะฝะพััะธ:**
โข ๐จ ะะฑะฝะพะฒะปะตะฝะธะต ะดะธะทะฐะนะฝะฐ ะดะพ ัะพะฒัะตะผะตะฝะฝัั ััะตะฝะดะพะฒ
โข โก ะะฟัะธะผะธะทะฐัะธั ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ ะฝะฐ 300%
โข ๐ ะฃัะธะปะตะฝะธะต ะฑะตะทะพะฟะฐัะฝะพััะธ ั ะฑะธะพะผะตััะธะตะน
โข ๐ ะะฝัะตะณัะฐัะธั ะฐะฝะฐะปะธัะธะบะธ ะดะปั ัะพััะฐ ะฑะธะทะฝะตัะฐ

ะะฐะบะธะต ัะปัััะตะฝะธั ะดะพะฑะฐะฒะปัะตะผ?"""

        suggestions = [
            "๐ค ะะพะฑะฐะฒะธัั AI-ััะฝะบัะธะธ",
            "๐จ ะะฑะฝะพะฒะธัั ะดะธะทะฐะนะฝ",
            "โก ะฃัะบะพัะธัั ะฟัะธะปะพะถะตะฝะธะต",
            "๐ฐ ะะฐัััะพะธัั ะผะพะฝะตัะธะทะฐัะธั"
        ]
        
        return {
            "type": "genius_response",
            "message": message,
            "suggestions": suggestions,
            "app_type": app_type
        }

    def _generate_advice_response(self, emotional_start: str, app_type: str) -> Dict[str, Any]:
        """ะะตะฝะตัะธััะตั ะพัะฒะตั-ัะพะฒะตั"""
        
        advice_by_type = {
            "ะธะณัั": "๐ฎ ะะณัั - ััะพ ะฒัะตะณะดะฐ ัะธั! ะัะพะฑะตะฝะฝะพ ั ัะฝะธะบะฐะปัะฝะพะน ะผะตัะฐะฝะธะบะพะน ะธ ัะพัะธะฐะปัะฝัะผะธ ัะปะตะผะตะฝัะฐะผะธ",
            "ัะพัะธะฐะปัะฝัะต": "๐ฌ ะกะพัะธะฐะปัะฝัะต ะฟัะธะปะพะถะตะฝะธั ะธะผะตัั ะพะณัะพะผะฝัะน ะฟะพัะตะฝัะธะฐะป ัะพััะฐ ะธ ะฒะธัััะฝะพััะธ",
            "ะฑะธะทะฝะตั": "๐ผ ะะธะทะฝะตั-ะฟัะธะปะพะถะตะฝะธั - ััะฐะฑะธะปัะฝัะน ะดะพัะพะด ัะตัะตะท ะฟะพะดะฟะธัะบะธ ะธ B2B ะฟัะพะดะฐะถะธ",
            "ะผะฐะณะฐะทะธะฝ": "๐ E-commerce - ะฑััััะพัะฐััััะธะน ััะฝะพะบ ั ะพัะปะธัะฝะพะน ะผะพะฝะตัะธะทะฐัะธะตะน",
            "ัะธะฝะฐะฝัั": "๐ฐ ะคะธะฝัะตั - ะพะดะธะฝ ะธะท ัะฐะผัั ะฟัะธะฑัะปัะฝัั ัะตะณะผะตะฝัะพะฒ ะผะพะฑะธะปัะฝัั ะฟัะธะปะพะถะตะฝะธะน"
        }
        
        advice_text = advice_by_type.get(app_type, "โจ ะัะฑะพะต ะฟัะธะปะพะถะตะฝะธะต ะผะพะถะตั ััะฐัั ััะฟะตัะฝัะผ ะฟัะธ ะฟัะฐะฒะธะปัะฝะพะผ ะฟะพะดัะพะดะต!")
        
        message = f"""{emotional_start}

๐ฏ **ะะฐะฒะฐะนัะต ะฝะฐะนะดะตะผ ะธะดะตะฐะปัะฝะพะต ัะตัะตะฝะธะต ะดะปั ะฒะฐั!**

๐ก **ะะพะน ัะพะฒะตั ะฟะพ {app_type}:**
{advice_text}

๐ **ะขะพะฟ-3 ััะตะฝะดะพะฒัั ะฝะฐะฟัะฐะฒะปะตะฝะธั ัะตะนัะฐั:**
1. ๐ค **AI-ะธะฝัะตะณัะฐัะธั** - ะฟะพะปัะทะพะฒะฐัะตะปะธ ะพะฑะพะถะฐัั ัะผะฝัะต ััะฝะบัะธะธ
2. ๐ **Real-time ะฒะทะฐะธะผะพะดะตะนััะฒะธะต** - ะผะณะฝะพะฒะตะฝะฝะพััั = engagement  
3. ๐จ **ะะตััะพะฝะฐะปะธะทะฐัะธั** - ัะฝะธะบะฐะปัะฝัะน ะพะฟัั ะดะปั ะบะฐะถะดะพะณะพ

๐ **ะฅะพัะธัะต ัะทะฝะฐัั ะบะพะฝะบัะตัะฝัะต ะธะดะตะธ ะดะปั ะฒะฐัะตะน ะฝะธัะธ?**"""

        suggestions = [
            f"๐ก ะะพะบะฐะทะฐัั ะธะดะตะธ ะดะปั {app_type}",
            "๐ ะะฝะฐะปะธะท ััะตะฝะดะพะฒ ััะฝะบะฐ",
            "๐ฐ ะัััะธะต ะผะพะดะตะปะธ ะผะพะฝะตัะธะทะฐัะธะธ",
            "๐ฏ ะะพะผะพัั ะฒัะฑัะฐัั ะฝะธัั"
        ]
        
        return {
            "type": "genius_response",
            "message": message,
            "suggestions": suggestions,
            "app_type": app_type
        }

    def _generate_trends_response(self, emotional_start: str) -> Dict[str, Any]:
        """ะะตะฝะตัะธััะตั ะพัะฒะตั ะพ ััะตะฝะดะฐั"""
        
        trends_2024 = [
            "๐ค **AI-ะธะฝัะตะณัะฐัะธั** - ะบะฐะถะดะพะต ะฟัะธะปะพะถะตะฝะธะต ะดะพะปะถะฝะพ ะฑััั ัะผะฝัะผ",
            "๐ฎ **ะะตะนะผะธัะธะบะฐัะธั** - ะฟัะตะฒัะฐัะฐะตะผ ัะบััะฝัะต ะทะฐะดะฐัะธ ะฒ ะธะณัั", 
            "๐ **Real-time ััะฝะบัะธะธ** - ะฒัะต ะดะพะปะถะฝะพ ัะฐะฑะพัะฐัั ะผะณะฝะพะฒะตะฝะฝะพ",
            "๐ **ะกัะฟะตัะฐะฟะฟ ะบะพะฝัะตะฟั** - ะพะดะฝะพ ะฟัะธะปะพะถะตะฝะธะต ะดะปั ะฒัะตั ะฝัะถะด",
            "๐จ **ะะตััะพะฝะฐะปะธะทะฐัะธั** - ัะฝะธะบะฐะปัะฝัะน ะพะฟัั ะดะปั ะบะฐะถะดะพะณะพ",
            "๐ **Privacy-first** - ะฑะตะทะพะฟะฐัะฝะพััั ะฟัะตะฒััะต ะฒัะตะณะพ"
        ]
        
        message = f"""{emotional_start}

๐ **ะะพั ััะพ ะฒะทััะฒะฐะตั ััะฝะพะบ ะฟัะธะปะพะถะตะฝะธะน ะฒ 2024!**

๐ฅ **ะะปะฐะฒะฝัะต ััะตะฝะดั:**

{chr(10).join(trends_2024)}

๐ฐ **ะกะฐะผัะต ะฟัะธะฑัะปัะฝัะต ะฝะธัะธ:**
โข ๐ฅ **HealthTech** - $350 ะผะปัะด ััะฝะพะบ
โข ๐ณ **FinTech** - $310 ะผะปัะด ััะฝะพะบ  
โข ๐ **EdTech** - $400 ะผะปัะด ััะฝะพะบ
โข ๐ **E-commerce** - $6.2 ััะปะฝ ััะฝะพะบ

๐ **ะะพัะพะฒ ัะพะทะดะฐัั ััะตะฝะดะพะฒะพะต ะฟัะธะปะพะถะตะฝะธะต?**"""

        suggestions = [
            "๐ค ะกะพะทะดะฐัั AI-ะฟัะธะปะพะถะตะฝะธะต",
            "๐ฅ HealthTech ัะตัะตะฝะธะต", 
            "๐ณ FinTech ะฟัะธะปะพะถะตะฝะธะต",
            "๐ฎ ะะตะนะผะธัะธัะธัะพะฒะฐะฝะฝะพะต ะฟัะธะปะพะถะตะฝะธะต"
        ]
        
        return {
            "type": "genius_response",
            "message": message,
            "suggestions": suggestions
        }

    def _generate_general_response(self, emotional_start: str, app_type: str) -> Dict[str, Any]:
        """ะะตะฝะตัะธััะตั ะพะฑัะธะน ะพัะฒะตั"""
        
        message = f"""{emotional_start}

๐ซ **ะฏ ะณะพัะพะฒ ัะพะทะดะฐัั ะดะปั ะฒะฐั ะฝะตะฒะตัะพััะฝะพะต ะฟัะธะปะพะถะตะฝะธะต!**

๐ฏ **ะงัะพ ัะผะตั:**
โข ๐ฑ ะัะฑัะต ะผะพะฑะธะปัะฝัะต ะฟัะธะปะพะถะตะฝะธั (iOS/Android)
โข ๐ ะะตะฑ-ะฟัะธะปะพะถะตะฝะธั ะธ PWA
โข ๐ค AI-ะธะฝัะตะณัะฐัะธั ะฒ ะปัะฑะพะน ะฟัะพะตะบั
โข ๐จ ะกะพะฒัะตะผะตะฝะฝัะน ะดะธะทะฐะนะฝ ะปัะฑะพะน ัะปะพะถะฝะพััะธ
โข ๐ฐ ะะฐัััะพะนะบะฐ ะผะพะฝะตัะธะทะฐัะธะธ

โก **ะกะบะพัะพััั ัะพะทะดะฐะฝะธั: 15 ะผะธะฝัั!**
๐ต **ะะพัะตะฝัะธะฐะป ะดะพัะพะดะฐ: ะดะพ $50,000/ะผะตััั**

ะะฐััะบะฐะถะธัะต, ััะพ ัะพัะธัะต ัะพะทะดะฐัั?"""

        suggestions = [
            "๐ฎ ะกะพะทะดะฐัั ะธะณัั",
            "๐ผ ะะธะทะฝะตั-ะฟัะธะปะพะถะตะฝะธะต",
            "๐ฌ ะกะพัะธะฐะปัะฝัั ัะตัั",
            "๐ก ะะพะบะฐะทะฐัั ะฒัะต ะฒะพะทะผะพะถะฝะพััะธ"
        ]
        
        return {
            "type": "genius_response", 
            "message": message,
            "suggestions": suggestions,
            "app_type": app_type
        }
